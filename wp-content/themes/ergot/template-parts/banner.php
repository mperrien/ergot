<?php
/**
 * Template part for displaying the banner of each page
 *
 * @link https://developer.wordpress.org/themes/basics/template-hierarchy/
 *
 * @package ergot
 */

?>
<div class="page-banner">
  <div class="page-banner__content">
    <?php if (is_page_template('template-front.php')) : ?>
      <svg class="page-banner__logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 400"><path fill="#fff" d="M150 258.31L38.9 194.16V65.87L150 1.73l111.1 64.14v128.29zm-99.53-66.45L150 249.33l99.79-57.62L202.55 165 150 195.32 97.54 165zM46.68 70.37v114.69l46.77-26.65v-61l53-30.59v-54zm159.87 87.94l46.77 26.46V70.37l-99.11-57.23v54l52.34 30.22zm-52.82-26.19v52.06l45-26v-51.76zm-52.5 26.06L146 184v-51.64l-44.72-25.83zM105 99.71l44.68 25.79 45.3-25.85L150 73.7z"/><path fill="#fff" d="M24.29 377.2q-7.71.8-12.29-2.91a14.21 14.21 0 01-5.25-10 27.41 27.41 0 011.53-11.54 46.11 46.11 0 016.1-11.95 41.35 41.35 0 019.22-9.55 21.87 21.87 0 0110.73-4.41 11.79 11.79 0 016.13 1c2 .88 3.16 2.93 3.5 6.14a15.16 15.16 0 01-1.75 8.82 27.22 27.22 0 01-6.35 7.85 43.52 43.52 0 01-9.27 6.14 45.42 45.42 0 01-10.5 3.72 7 7 0 00-.07 1 16.41 16.41 0 00.12 1.75c0 .41.18 1.1.4 2.09a9.9 9.9 0 001.36 3.08 7.31 7.31 0 003.1 2.67 10 10 0 005.42.65 21.08 21.08 0 009.87-3.9 40.82 40.82 0 008.84-8.53 45.38 45.38 0 006.42-11.26l2.61 1.67a45.65 45.65 0 01-7 13.51 39.46 39.46 0 01-10.43 9.62 29.13 29.13 0 01-12.44 4.34zM17 356a23.14 23.14 0 006.75-2.9 39.38 39.38 0 006.92-5.35 28.21 28.21 0 005.2-6.69 11.73 11.73 0 001.58-6.92 2.61 2.61 0 00-.67-1.76 2.19 2.19 0 00-1.62-.31 10.57 10.57 0 00-5.56 2.59 31.79 31.79 0 00-5.36 5.79A45.66 45.66 0 0017 356z"/><path fill="#fff" d="M73.4 369.85a10.86 10.86 0 01-7.47-1.59 7.9 7.9 0 01-3.43-6 18 18 0 01.93-7.4q1.27-4 2.63-7.94a16.08 16.08 0 001-6.8 6.48 6.48 0 00-2.29-4.44 15.64 15.64 0 00-4.49-2.68 128.9 128.9 0 01-4.61 13.44Q53 353 51.34 356.71l-2.18-3.3q1.37-3.3 3.52-9.37a132 132 0 003.94-13.43 4.39 4.39 0 01-1.54-3.13 10.17 10.17 0 011.3-6.09c1.09-2 2.24-3 3.44-3.16a2.22 2.22 0 012.28 1.4 7.53 7.53 0 01.89 2.16 7.82 7.82 0 01-.31 2.22l-.54 2.37c.17.87 1 1.66 2.38 2.36s3 1.53 4.82 2.48a18.62 18.62 0 014.89 3.78 10.29 10.29 0 012.6 6.18 17.93 17.93 0 01-.83 7.22q-1.19 3.78-2.42 7.07a12.66 12.66 0 00-1 5.58 2.39 2.39 0 001.13 2.13 4.07 4.07 0 002.17.32 12.37 12.37 0 005.83-2.38 32.47 32.47 0 005.68-5.12 42.08 42.08 0 004.68-6.39 34.59 34.59 0 002.91-6l3.11 1.86a40.87 40.87 0 01-5.55 10.87 40.26 40.26 0 01-8.77 9.19 20.63 20.63 0 01-10.37 4.32z"/><path fill="#fff" d="M104.05 397.53a9.67 9.67 0 01-5.79-1.22c-1.85-1-2.92-2.9-3.21-5.62a11.65 11.65 0 011.5-7.16 25 25 0 015.31-6.27 66 66 0 017.38-5.58q4-2.61 7.75-5c.66-2.26 1.25-4.67 1.79-7.24s1-5.34 1.44-8.3a49.27 49.27 0 01-7.92 9.71 15.69 15.69 0 01-9.08 4.49 9.55 9.55 0 01-8-2.57 13.5 13.5 0 01-3.77-8.61 24 24 0 011.93-12.31 38.71 38.71 0 017.2-10.85 41.07 41.07 0 0110.11-8 28.24 28.24 0 0110.81-3.63 9.93 9.93 0 015.92.78 3.94 3.94 0 012.26 3 3.14 3.14 0 01-.6 2.38 6.31 6.31 0 01-1 1.07 6.09 6.09 0 00-2.65-1.48 9.45 9.45 0 00-3-.11 17.11 17.11 0 00-8.74 3.59 29.18 29.18 0 00-6.93 7.6 38.1 38.1 0 00-4.33 9.16 20.76 20.76 0 00-1.08 8.26 5.54 5.54 0 001.47 3.56 3.4 3.4 0 002.78 1q3.38-.36 7.72-5.26a67 67 0 008.15-11.62c.09-.66.17-1.25.24-1.79s.11-1 .14-1.53a20.83 20.83 0 012.14-7.41 5.53 5.53 0 014.45-2.78 13.75 13.75 0 011.52 0c.61 0 1.29.07 2 .16a34.31 34.31 0 01-.45 7.22q-.69 5.07-2 11.84t-3.17 13.89a37.34 37.34 0 007.12-5.18 38.2 38.2 0 006.38-7.61 29.29 29.29 0 004-9.48l2.4 1.94a30.39 30.39 0 01-4.9 10.73 51.07 51.07 0 01-7.89 8.8 55.08 55.08 0 01-8.13 6 119.07 119.07 0 01-5.52 15.24 44 44 0 01-7 11.32 13.48 13.48 0 01-8.75 4.87zM103 392q2.17-.23 5.53-4.71t6.79-14.71q-4.23 2.64-7.72 5.31a27.65 27.65 0 00-5.51 5.45 7.91 7.91 0 00-1.73 5.53 4.06 4.06 0 00.93 2.4 1.93 1.93 0 001.71.73z"/><path fill="#fff" d="M173.21 366.78a23.41 23.41 0 01-13.14-2.33 25.62 25.62 0 01-10.24-9.45 35.87 35.87 0 01-5.07-15.77 64.21 64.21 0 01.92-19 84.63 84.63 0 016-18.88 77.75 77.75 0 0110.17-16.65 57.28 57.28 0 0113.26-12.22 34.33 34.33 0 0115.29-5.56 20.49 20.49 0 013.6.11 9.22 9.22 0 014.94 2.4h-1.65c-.65 0-1.23.07-1.87.14a24.11 24.11 0 00-12.22 5.24 53.54 53.54 0 00-11.05 11.8 82 82 0 00-8.71 16.07 89.56 89.56 0 00-5.34 18.14 62.67 62.67 0 00-.8 17.85 39.4 39.4 0 002.91 11.49 19.07 19.07 0 006.34 8.16q4.07 2.91 10.21 2.27a21.65 21.65 0 0012-5.27 42.42 42.42 0 009.35-11.75 76.34 76.34 0 006.49-15.77 96.52 96.52 0 003.4-17.55 82.61 82.61 0 00.06-16.85 65.64 65.64 0 00-1.27-7.47 27.9 27.9 0 00-2.36-6.75c-1-1.85-2.17-2.69-3.61-2.54s-2.76 1.16-4.18 3.05a36.23 36.23 0 00-4 7.06 64.35 64.35 0 00-3.16 8.78 48.27 48.27 0 00-1.63 8.14q-4.19-.41-6.12-2a6 6 0 01-2.2-4.15 14.78 14.78 0 011.53-7.46 36.94 36.94 0 015.15-8.27 40.14 40.14 0 017.07-6.88 14.78 14.78 0 017.26-3.2 7.38 7.38 0 016.11 2 17.89 17.89 0 014.15 6.29 48.5 48.5 0 012.6 8.55 83 83 0 011.39 8.55 79.45 79.45 0 01-.65 22.76 68.25 68.25 0 01-6.23 18.85 62.15 62.15 0 01-10 14.43 48.7 48.7 0 01-12.14 9.55 33.51 33.51 0 01-12.56 4.09z"/><path fill="#fff" d="M247.58 359c-4.42.47-7.56-.08-9.42-1.62a9.61 9.61 0 01-3.35-6.4 31.36 31.36 0 01.5-8.51q.87-5 1.85-9.63 2-8.85 4.25-17.48t4.59-16.71q2.39-8 4.6-15.32t4.12-13.45q-8.17 1-14.09 2t-10.8 2.05Q225 275 219.8 276.47a10.32 10.32 0 013.94-8.26 28.43 28.43 0 0110.73-5 107.2 107.2 0 0115.89-2.77q4.69-.5 8.87-.75c2.78-.17 5.45-.26 8-.29l7.47-.06c5.11 0 9.17-.15 12.2-.3s5.18-.3 6.46-.44a21.5 21.5 0 01-8.57 5.83 55.89 55.89 0 01-11.3 3.07q-6 1-11.39 1.57-4.29 14.81-7.49 30.59t-5.73 31.14q-1 5.94-1.56 10.08a73.15 73.15 0 00-.73 7.5 49.29 49.29 0 00.26 7.09c0 .4.11.86.2 1.38s.27 1.25.53 2.15z"/></svg>
    <?php else : ?>
      <svg class="page-banner__logo page-banner__logo--simple" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 280"><path fill="#fff" d="M150 258.31L38.9 194.16V65.87L150 1.73l111.1 64.14v128.29zm-99.53-66.45L150 249.33l99.79-57.62L202.55 165 150 195.32 97.54 165zM46.68 70.37v114.69l46.77-26.65v-61l53-30.59v-54zm159.87 87.94l46.77 26.46V70.37l-99.11-57.23v54l52.34 30.22zm-52.82-26.19v52.06l45-26v-51.76zm-52.5 26.06L146 184v-51.64l-44.72-25.83zM105 99.71l44.68 25.79 45.3-25.85L150 73.7z"/></svg>
    <?php endif; ?>
    <?php
      the_title( '<h1 class="page-title">', '</h1>' );
    ?>
    <div class="page-banner__text copy">
    <?php
      if (is_page_template('template-accompaniment.php') || is_page_template('template-front.php')) {
        the_content();
      } else if (get_field('introduction')) {
        the_field('introduction');
      }
    ?>
    </div>
    <?php
      $button = get_field('main-button');
      if ($button) : ?>
        <div class="page-banner__cta">
          <a href="<?php echo esc_url($button['link']); ?>" class="button button--purple">
            <?php echo esc_html($button['text']); ?>
          </a>
        </div>
      <?php endif;
    ?>
    <?php
    if (is_page_template('template-accompaniment.php')) {
      $args = array(
        'post_type'      => 'page',
        'posts_per_page' => -1,
        'post_parent'    => $post->ID,
        'order'          => 'ASC',
        'orderby'        => 'menu_order'
      );
      $children = new WP_Query( $args );
      if ( $children->have_posts() ) : ?>
        <nav class="page-banner__nav">
        <?php while ( $children->have_posts() ) : $children->the_post(); ?>
          <a href="<?php the_permalink(); ?>"><?php the_title(); ?></a>
        <?php endwhile; ?>
        </nav>
      <?php endif; wp_reset_postdata();
    }
    ?>
  </div>
  <div class="page-banner__image">
  <?php
    // $image = get_the_post_thumbnail();
    $image_id = get_post_thumbnail_id();
    $image_large = wp_get_attachment_image_src( $image_id, "large" );
    $image_huge = wp_get_attachment_image_src( $image_id, "1536x1536" );
  ?>
  <style>
    .page-banner__image {
      background-image: url('<?php echo $image_large[0]; ?>');
    }
    @media (min-width: 40em) {
      .page-banner__image {
        background-image: url('<?php echo $image_huge[0]; ?>');
      }
    }
    @media (min-width: 60em) {
      .page-banner__image {
        background-image: url('<?php echo $image_large[0]; ?>');
      }
    }
    @media (min-width: 80em) {
      .page-banner__image {
        background-image: url('<?php echo $image_huge[0]; ?>');
      }
    }
  </style>
  </div>
</div>
